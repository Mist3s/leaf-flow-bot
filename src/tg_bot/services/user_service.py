from __future__ import annotations

from tg_bot.api_client.models import UserProfile
from tg_bot.services.order_service import OrdersTextBuilder


class UserService:
    def __init__(self, *, order_builder: OrdersTextBuilder, webapp_url: str):
        self.order_builder = order_builder
        self.webapp_url = webapp_url

    def greeting_for_unknown(self, first_name: str | None) -> tuple[str, list[tuple[str, str]]]:
        name = first_name or "ะดััะณ"
        text = (
            f"ะัะธะฒะตั, {name} ๐\n\n"
            "ะะพัะพะถะต, ะฒั ะตัั ะฝะต ะทะฐัะพะดะธะปะธ ะฒ ะฝะฐัะต ะฟัะธะปะพะถะตะฝะธะต.\n\n"
            "ะงะตัะตะท ะฟัะธะปะพะถะตะฝะธะต ะฒั ะผะพะถะตัะต:\n"
            "โข ะฟะพัะผะพััะตัั ะบะฐัะฐะปะพะณ ัะพะฒะฐัะพะฒ\n"
            "โข ัะพะฑัะฐัั ะบะพัะทะธะฝั\n"
            "โข ะพัะพัะผะธัั ะฟะตัะฒัะน ะทะฐะบะฐะท\n\n"
            "ะะฐะถะผะธัะต ะบะฝะพะฟะบั ะฝะธะถะต, ััะพะฑั ะพัะบัััั ะฟัะธะปะพะถะตะฝะธะต."
        )
        buttons = [("ะัะบัััั ะฟัะธะปะพะถะตะฝะธะต", self.webapp_url)]
        return text, buttons

    @staticmethod
    def greeting_with_orders(user: UserProfile, has_orders: bool) -> tuple[str, list[str]]:
        name = user.firstName or "ะดััะณ"
        if not has_orders:
            text = (
                f"ะัะธะฒะตั, {name} ๐\n\n"
                "ะฃ ะฒะฐั ะฟะพะบะฐ ะฝะตั ะทะฐะบะฐะทะพะฒ.\n"
                "ะั ะผะพะถะตัะต ัะดะตะปะฐัั ะฟะตัะฒัะน ะทะฐะบะฐะท ัะตัะตะท ะฝะฐัะต ะฟัะธะปะพะถะตะฝะธะต โ ัะฐะผ ัะดะพะฑะฝะพ ะฒัะฑัะฐัั ัะพะฒะฐั ะธ ะพัะพัะผะธัั ะดะพััะฐะฒะบั.\n\n"
                "ะัะฟะพะปัะทัะนัะต ะผะตะฝั:\n"
                "โข ๐ฆ ะะพะธ ะทะฐะบะฐะทั\n"
                "โข ๐ ะัะบัััั ะฟัะธะปะพะถะตะฝะธะต\n"
                "โข ๐จโ๐ป ะะพะดะดะตัะถะบะฐ"
            )
        else:
            text = (
                f"ะัะธะฒะตั, {name}!\n\n"
                "ะั ะผะพะถะตัะต:\n"
                "โข ๐ฆ ะฟะพัะผะพััะตัั ัะฒะพะธ ะทะฐะบะฐะทั\n"
                "โข ๐จโ๐ป ะฝะฐะฟะธัะฐัั ะฒ ะฟะพะดะดะตัะถะบั\n"
                "โข ๐ ะพัะบัััั ะฟัะธะปะพะถะตะฝะธะต ั ะบะฐัะฐะปะพะณะพะผ\n\n"
                "ะัะฑะตัะธัะต ะฟัะฝะบั ะฒ ะผะตะฝั."
            )
        return text, ["๐ฆ ะะพะธ ะทะฐะบะฐะทั", "๐ ะัะบัััั ะฟัะธะปะพะถะตะฝะธะต", "๐จโ๐ป ะะพะดะดะตัะถะบะฐ"]
